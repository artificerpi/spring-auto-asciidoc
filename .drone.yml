name: default

kind: pipeline
type: docker

steps:
- name: gradle-builder
  image: gradle
  environment:
    GPR_USER:
      from_secret: gpr_user
    GPR_API_KEY:
      from_secret: gpr_key
  commands:
    - gradle -x functionTest clean build
    # - gradle publishPlugins -Pgradle.publish.key=$GRADLE_PUBLISH_KEY -Pgradle.publish.secret=$GRADLE_PUBLISH_SECRET
    - gradle publishGprPublicationToGitHubPackagesRepository
